{% extends "base.html" %}

{% block content %}
    <h4>annualized spending: {{ '${:,.2f}'.format(annual_budget) }}</h4>
    Topline Spending Summary<br>
    <!-- topline_spending_summary is a list
      [0] contains name of summary
      [1] contains either the number of categories or number of items
      [2] contains list of lists containing summary rows with cell data
     -->
        {% for list in topline_spending_summary %}
            {{ list[0] }}, including  {{ list[1] }} categories <a href="{{ url_for('spending_analysis') }}">(details)</a>
            {% include 'snippets/summary_table.html' %}
        {% endfor %}
    <br>
    <table border="1px solid black">
        {% for i in last_year_cats_metadata_list %}
            <tr>
                <td><a href="{{ url_for('category', cat=i[0]) }}">{{ i[0] }}</a></td>
                {% for j in i[1:] %}
                <td>{% if j is float %}
                    {{ '{:,.2f}'.format(j) }}
                    {% else %}
                    {{ j }}
                {% endif %}</td>
                {% endfor %}
            </tr>
        {% endfor %}
    </table>
    <details>
    <summary class="tab">categories to be looked at...</summary>
    <details>
    <summary>over spending tolerance in...</summary>
        {% for i in overspent_cat_by_summary_tag %}
            <details><summary>{{ i[0] }}</summary>
            {% for j in i[1] %}
                <a href="{{ url_for('category', cat=j) }}">{{ j }}</a><br>
            {% endfor %}
            </details>
        {% endfor %}
    </details>
    <details><summary>categories over any tolerance ordered by average monthly spend</summary>
       {% include 'snippets/metadata_from_list.html' %}
    </details>
    </details>
    <br>
    <h3>Flagged categories</h3>
    {% for i in categories_by_state %}
        {{ i[0] }}:
        {% for l in i[1] %}
            <a href="{{ url_for('category', cat=l) }}">{{ l }}</a>
        {% endfor %}
        <br>
    {% endfor %}
    <br>
{% endblock %}